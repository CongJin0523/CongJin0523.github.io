import{af as P,d as x,aE as k,G as R,O as $,K as n,I as a,H as t,aF as A,u as d,aG as y,s as B,Q as F,aH as N,aI as V,aK as T,aL as z,W as _,X as G,aM as L,aN as f,aO as S}from"./index-C9cvMYIp.js";import{E as q,k as H,e as K,f as M,h as O,j as W}from"./el-input-B3Xi45Qr.js";import"./index-CSZUZrxi.js";const j={style:{"text-align":"center",margin:"0 40px"}},D={style:{"margin-top":"50px",width:"100%"}},Q={style:{"margin-top":"50px"}},X={style:{"margin-top":"20px"}},Z={__name:"register",setup(J){const o=x(0),c=x(),s=k({username:"",password:"",password_repeat:"",email:"",code:""}),h={username:[{validator:(p,e,l)=>{e===""?l(new Error("please enter username")):/^[a-zA-Z0-9]+$/.test(e)?l():l(new Error("Username is not allowed including special characters"))},trigger:["blur","change"]}],password:[{required:!0,messages:"please enter password",trigger:"blur"},{min:6,max:20,message:"The length of password must be between 6 and 20 characters",trigger:["blur","change"]}],password_repeat:[{validator:(p,e,l)=>{e===""?l(new Error("please enter password again")):e!==s.password?l(new Error("Password twice does not match")):l()},trigger:["blur","change"]}],email:[{required:!0,type:"email",trigger:["blur","change"],messages:"Please enter valid email"}],code:[{validator:(p,e,l)=>{/^[0-9]{6}$/.test(e)?l():l(new Error("please enter valid code"))},trigger:["blur","change"]}]};let i=null;function E(){g?L(`/api/auth/verify-code?email=${s.email}&type=register`,()=>{o.value=60,i=setInterval(()=>{o.value--,o.value<=0&&(clearInterval(i),i=null)},1e3),f.success("Verification Code has been sent successfully!")},()=>{clearInterval(i),i=null,o.value=0,f.error("Verification Code sent failed! Please try again!")}):f.error("Please enter a valid email")}const g=R(()=>/^[\w\\.-]+@[\w\\.-]+\.\w+$/.test(s.email));function C(){c.value.validate(p=>{p?S("/api/auth/register",{username:s.username,password:s.password,email:s.email,code:s.code},()=>{f.success("Register successfully!"),y.push("/")}):f.error("Please check the form for errors.")})}return(p,e)=>{const l=F,u=M,m=K,w=W,v=A,b=O,I=q,U=H;return B(),$("div",j,[e[9]||(e[9]=n("div",{style:{"margin-top":"150px"}},[n("div",{style:{"font-size":"25px","font-weight":"bold"}},"Create a AW Account")],-1)),n("div",D,[a(I,{model:s,"label-position":"top",rules:h,ref_key:"formRef",ref:c},{default:t(()=>[a(m,{prop:"username"},{default:t(()=>[a(u,{modelValue:s.username,"onUpdate:modelValue":e[0]||(e[0]=r=>s.username=r),placeholder:"Username",maxlength:"20",type:"text"},{prefix:t(()=>[a(l,null,{default:t(()=>[a(d(N))]),_:1})]),_:1},8,["modelValue"])]),_:1}),a(m,{prop:"password"},{default:t(()=>[a(u,{modelValue:s.password,"onUpdate:modelValue":e[1]||(e[1]=r=>s.password=r),placeholder:"Password",maxlength:"20",type:"password"},{prefix:t(()=>[a(l,null,{default:t(()=>[a(d(V))]),_:1})]),_:1},8,["modelValue"])]),_:1}),a(m,{prop:"password_repeat"},{default:t(()=>[a(u,{modelValue:s.password_repeat,"onUpdate:modelValue":e[2]||(e[2]=r=>s.password_repeat=r),placeholder:"Repeat password",maxlength:"20",type:"password"},{prefix:t(()=>[a(l,null,{default:t(()=>[a(d(V))]),_:1})]),_:1},8,["modelValue"])]),_:1}),a(m,{prop:"email"},{default:t(()=>[a(u,{modelValue:s.email,"onUpdate:modelValue":e[3]||(e[3]=r=>s.email=r),placeholder:"email",type:"text"},{prefix:t(()=>[a(l,null,{default:t(()=>[a(d(T))]),_:1})]),_:1},8,["modelValue"])]),_:1}),a(m,{prop:"code"},{default:t(()=>[a(b,{gutter:10,style:{width:"100%"}},{default:t(()=>[a(w,{span:17},{default:t(()=>[a(u,{modelValue:s.code,"onUpdate:modelValue":e[4]||(e[4]=r=>s.code=r),placeholder:"Enter Code",minlength:"6",maxlength:"6",type:"text"},{prefix:t(()=>[a(l,null,{default:t(()=>[a(d(z))]),_:1})]),_:1},8,["modelValue"])]),_:1}),a(w,{span:5},{default:t(()=>[a(v,{onClick:E,disabled:!g.value||o.value,type:"success"},{default:t(()=>[_(G(o.value>0?`Try again after ${o.value}S`:"Get Code"),1)]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),n("div",Q,[a(v,{onClick:C,type:"primary",style:{width:"80%"}},{default:t(()=>e[6]||(e[6]=[_("Submit")])),_:1})]),n("div",X,[e[8]||(e[8]=n("span",{style:{"font-size":"14px","line-height":"15px"}},"Already have an account? ",-1)),a(U,{style:{translate:"0 -1px"},onClick:e[5]||(e[5]=r=>d(y).push("/"))},{default:t(()=>e[7]||(e[7]=[_("Log in")])),_:1})])])}}},re=P(Z,[["__scopeId","data-v-55dcb33a"]]);export{re as default};
