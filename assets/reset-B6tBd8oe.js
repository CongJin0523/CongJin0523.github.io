import{aa as A,aP as U,F as le,l as J,v as Y,_ as Z,f as O,C as ee,w as j,O as C,s as y,h as D,M as _,u as s,as as se,p as re,aQ as ne,d as R,ao as ie,o as pe,c as ue,aE as te,G as w,N,K as p,L as H,q as L,H as i,$ as de,Q as G,I as n,aR as ce,R as me,X as M,W as I,t as ve,aD as fe,aF as _e,aG as K,aK as ye,aL as ge,aI as Q,aM as we,aN as $,aO as X}from"./index-C9cvMYIp.js";import{C as ae,E as he,k as Se,e as Ce,f as xe,h as Ee,j as Ve}from"./el-input-B3Xi45Qr.js";import"./index-CSZUZrxi.js";const B=v=>{const u=A(v)?v:[v],e=[];return u.forEach(a=>{var d;A(a)?e.push(...B(a)):U(a)&&((d=a.component)!=null&&d.subTree)?e.push(a,...B(a.component.subTree)):U(a)&&A(a.children)?e.push(...B(a.children)):U(a)&&a.shapeFlag===2?e.push(...B(a.type())):e.push(a)}),e},be=(v,u,e)=>B(v.subTree).filter(t=>{var o;return U(t)&&((o=t.type)==null?void 0:o.name)===u&&!!t.component}).map(t=>t.component.uid).map(t=>e[t]).filter(t=>!!t),ke=(v,u)=>{const e={},a=le([]);return{children:a,addChild:o=>{e[o.uid]=o,a.value=be(v,u,e)},removeChild:o=>{delete e[o],a.value=a.value.filter(c=>c.uid!==o)}}},Pe=J({space:{type:[Number,String],default:""},active:{type:Number,default:0},direction:{type:String,default:"horizontal",values:["horizontal","vertical"]},alignCenter:{type:Boolean},simple:{type:Boolean},finishStatus:{type:String,values:["wait","process","finish","error","success"],default:"finish"},processStatus:{type:String,values:["wait","process","finish","error","success"],default:"process"}}),$e={[ae]:(v,u)=>[v,u].every(Y)},Ne=O({name:"ElSteps"}),Ie=O({...Ne,props:Pe,emits:$e,setup(v,{emit:u}){const e=v,a=ee("steps"),{children:d,addChild:t,removeChild:o}=ke(se(),"ElStep");return j(d,()=>{d.value.forEach((c,f)=>{c.setIndex(f)})}),re("ElSteps",{props:e,steps:d,addStep:t,removeStep:o}),j(()=>e.active,(c,f)=>{u(ae,c,f)}),(c,f)=>(y(),C("div",{class:_([s(a).b(),s(a).m(c.simple?"simple":c.direction)])},[D(c.$slots,"default")],2))}});var Re=Z(Ie,[["__file","steps.vue"]]);const ze=J({title:{type:String,default:""},icon:{type:ne},description:{type:String,default:""},status:{type:String,values:["","wait","process","finish","error","success"],default:""}}),Be=O({name:"ElStep"}),Te=O({...Be,props:ze,setup(v){const u=v,e=ee("step"),a=R(-1),d=R({}),t=R(""),o=ie("ElSteps"),c=se();pe(()=>{j([()=>o.props.active,()=>o.props.processStatus,()=>o.props.finishStatus],([l])=>{F(l)},{immediate:!0})}),ue(()=>{o.removeStep(P.uid)});const f=w(()=>u.status||t.value),W=w(()=>{const l=o.steps.value[a.value-1];return l?l.currentStatus:"wait"}),E=w(()=>o.props.alignCenter),T=w(()=>o.props.direction==="vertical"),h=w(()=>o.props.simple),x=w(()=>o.steps.value.length),r=w(()=>{var l;return((l=o.steps.value[x.value-1])==null?void 0:l.uid)===(c==null?void 0:c.uid)}),m=w(()=>h.value?"":o.props.space),q=w(()=>[e.b(),e.is(h.value?"simple":o.props.direction),e.is("flex",r.value&&!m.value&&!E.value),e.is("center",E.value&&!T.value&&!h.value)]),V=w(()=>{const l={flexBasis:Y(m.value)?`${m.value}px`:m.value?m.value:`${100/(x.value-(E.value?0:1))}%`};return T.value||r.value&&(l.maxWidth=`${100/x.value}%`),l}),b=l=>{a.value=l},k=l=>{const S=l==="wait",z={transitionDelay:`${S?"-":""}${150*a.value}ms`},g=l===o.props.processStatus||S?0:100;z.borderWidth=g&&!h.value?"1px":0,z[o.props.direction==="vertical"?"height":"width"]=`${g}%`,d.value=z},F=l=>{l>a.value?t.value=o.props.finishStatus:l===a.value&&W.value!=="error"?t.value=o.props.processStatus:t.value="wait";const S=o.steps.value[a.value-1];S&&S.calcProgress(t.value)},P=te({uid:c.uid,currentStatus:f,setIndex:b,calcProgress:k});return o.addStep(P),(l,S)=>(y(),C("div",{style:H(s(V)),class:_(s(q))},[N(" icon & line "),p("div",{class:_([s(e).e("head"),s(e).is(s(f))])},[s(h)?N("v-if",!0):(y(),C("div",{key:0,class:_(s(e).e("line"))},[p("i",{class:_(s(e).e("line-inner")),style:H(d.value)},null,6)],2)),p("div",{class:_([s(e).e("icon"),s(e).is(l.icon||l.$slots.icon?"icon":"text")])},[D(l.$slots,"icon",{},()=>[l.icon?(y(),L(s(G),{key:0,class:_(s(e).e("icon-inner"))},{default:i(()=>[(y(),L(de(l.icon)))]),_:1},8,["class"])):s(f)==="success"?(y(),L(s(G),{key:1,class:_([s(e).e("icon-inner"),s(e).is("status")])},{default:i(()=>[n(s(ce))]),_:1},8,["class"])):s(f)==="error"?(y(),L(s(G),{key:2,class:_([s(e).e("icon-inner"),s(e).is("status")])},{default:i(()=>[n(s(me))]),_:1},8,["class"])):s(h)?N("v-if",!0):(y(),C("div",{key:3,class:_(s(e).e("icon-inner"))},M(a.value+1),3))])],2)],2),N(" title & description "),p("div",{class:_(s(e).e("main"))},[p("div",{class:_([s(e).e("title"),s(e).is(s(f))])},[D(l.$slots,"title",{},()=>[I(M(l.title),1)])],2),s(h)?(y(),C("div",{key:0,class:_(s(e).e("arrow"))},null,2)):(y(),C("div",{key:1,class:_([s(e).e("description"),s(e).is(s(f))])},[D(l.$slots,"description",{},()=>[I(M(l.description),1)])],2))],2)],6))}});var oe=Z(Te,[["__file","item.vue"]]);const Fe=ve(Re,{Step:oe}),Le=fe(oe),Ue={style:{"margin-top":"150px"}},De={key:0,style:{"text-align":"center",margin:"0 40px"}},Ge={style:{"margin-top":"50px",width:"100%"}},Me={style:{"margin-top":"50px"}},Oe={key:1,style:{"text-align":"center",margin:"0 40px"}},We={style:{"margin-top":"50px"}},qe={style:{"margin-top":"50px"}},Ae={style:{"margin-top":"20px","text-align":"center"}},Qe={__name:"reset",setup(v){const u=R(0),e=R(0),a=R();let d=null;const t=te({email:"",code:"",password:"",password_repeat:""}),o=(x,r,m)=>{r===""?m(new Error("please enter password again")):r!==t.password?m(new Error("Password twice does not match")):m()},c=(x,r,m)=>{/^[0-9]{6}$/.test(r)?m():m(new Error("please enter valid code"))},f=w(()=>/^[\w\\.-]+@[\w\\.-]+\.\w+$/.test(t.email));function W(){f?we(`/api/auth/verify-code?email=${t.email}&type=reset`,()=>{e.value=60,d=setInterval(()=>{e.value--,e.value<=0&&(clearInterval(d),d=null)},1e3),$.success("Verification Code has been sent successfully!")},()=>{clearInterval(d),d=null,e.value=0,$.error("Verification Code sent failed! Please try again!")}):$.error("Please enter a valid email")}const E={password:[{required:!0,messages:"please enter password",trigger:"blur"},{min:6,max:20,message:"The length of password must be between 6 and 20 characters",trigger:["blur","change"]}],password_repeat:[{validator:o,trigger:["blur","change"]}],email:[{required:!0,type:"email",trigger:["blur","change"],messages:"Please enter valid email"}],code:[{validator:c,trigger:["blur","change"]}]};function T(){X("/api/auth/confirm-verify-code",{email:t.email,code:t.code},()=>{u.value++},()=>{$.warning("Verification code is incorrect! Please try again!")})}function h(){K.push("/"),a.value.validate(x=>{x?X("/api/auth/reset-password",{password:t.password,email:t.email,code:t.code},()=>{$.success("Reset successfully!"),u.value=0,K.push("/")}):$.error("Please check the form for errors.")})}return(x,r)=>{const m=Le,q=Fe,V=G,b=xe,k=Ce,F=Ve,P=_e,l=Ee,S=he,z=Se;return y(),C("div",null,[p("div",Ue,[n(q,{"align-center":"",active:u.value,"finish-status":"success"},{default:i(()=>[n(m,{title:"Validate Email"}),n(m,{title:"Reset Password"})]),_:1},8,["active"])]),u.value===0?(y(),C("div",De,[r[6]||(r[6]=p("div",{style:{"margin-top":"50px"}},[p("div",{style:{"font-size":"25px","font-weight":"bold"}},"Reset Password"),p("div",{style:{"font-size":"14px",color:"gray"}},"Please enter the email used when you registered")],-1)),p("div",Ge,[n(S,{model:t,"label-position":"top",rules:E},{default:i(()=>[n(k,{prop:"email"},{default:i(()=>[n(b,{modelValue:t.email,"onUpdate:modelValue":r[0]||(r[0]=g=>t.email=g),placeholder:"Please enter account email",type:"text"},{prefix:i(()=>[n(V,null,{default:i(()=>[n(s(ye))]),_:1})]),_:1},8,["modelValue"])]),_:1}),n(k,{prop:"code"},{default:i(()=>[n(l,{gutter:10,style:{width:"100%"}},{default:i(()=>[n(F,{span:17},{default:i(()=>[n(b,{modelValue:t.code,"onUpdate:modelValue":r[1]||(r[1]=g=>t.code=g),placeholder:"Enter Code",minlength:"6",maxlength:"6",type:"text"},{prefix:i(()=>[n(V,null,{default:i(()=>[n(s(ge))]),_:1})]),_:1},8,["modelValue"])]),_:1}),n(F,{span:5},{default:i(()=>[n(P,{onClick:W,disabled:!f.value||e.value,type:"success"},{default:i(()=>[I(M(e.value>0?`Try again after ${e.value}S`:"Get Code"),1)]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),p("div",Me,[n(P,{onClick:T,type:"primary",style:{width:"80%"}},{default:i(()=>r[5]||(r[5]=[I("Start Reset")])),_:1})])])):N("",!0),u.value===1?(y(),C("div",Oe,[r[8]||(r[8]=p("div",{style:{"margin-top":"50px"}},[p("div",{style:{"font-size":"25px","font-weight":"bold"}},"Reset Password"),p("div",{style:{"font-size":"14px",color:"gray"}},"Please enter your new password")],-1)),p("div",We,[n(S,{model:t,"label-position":"top",rules:E,ref_key:"formRef",ref:a},{default:i(()=>[n(k,{prop:"password"},{default:i(()=>[n(b,{modelValue:t.password,"onUpdate:modelValue":r[2]||(r[2]=g=>t.password=g),placeholder:"Password",maxlength:"20",type:"password"},{prefix:i(()=>[n(V,null,{default:i(()=>[n(s(Q))]),_:1})]),_:1},8,["modelValue"])]),_:1}),n(k,{prop:"password_repeat"},{default:i(()=>[n(b,{modelValue:t.password_repeat,"onUpdate:modelValue":r[3]||(r[3]=g=>t.password_repeat=g),placeholder:"Repeat password",maxlength:"20",type:"password"},{prefix:i(()=>[n(V,null,{default:i(()=>[n(s(Q))]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),p("div",qe,[n(P,{onClick:h,type:"primary",style:{width:"80%"}},{default:i(()=>r[7]||(r[7]=[I("Reset")])),_:1})])])):N("",!0),p("div",Ae,[r[10]||(r[10]=p("span",{style:{"font-size":"14px","line-height":"15px"}},"Already have an account? ",-1)),n(z,{style:{translate:"0 -1px"},onClick:r[4]||(r[4]=g=>s(K).push("/"))},{default:i(()=>r[9]||(r[9]=[I("Log in")])),_:1})])])}}};export{Qe as default};
